import{Dimension}from"../../dom.js";import{OrthogonalEdge,Sash}from"../sash/sash.js";import{Emitter,Event}from"../../../common/event.js";import{DisposableStore}from"../../../common/lifecycle.js";export class ResizableHTMLElement{constructor(){let s;this._onDidWillResize=new Emitter,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new Emitter,this.onDidResize=this._onDidResize.event,this._sashListener=new DisposableStore,this._size=new Dimension(0,0),this._minSize=new Dimension(0,0),this._maxSize=new Dimension(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Sash(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Sash(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Sash(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:OrthogonalEdge.North}),this._southSash=new Sash(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:OrthogonalEdge.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let t=0,i=0;this._sashListener.add(Event.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)((()=>{void 0===s&&(this._onDidWillResize.fire(),s=this._size,t=0,i=0)}))),this._sashListener.add(Event.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)((()=>{void 0!==s&&(s=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(this._eastSash.onDidChange((e=>{s&&(i=e.currentX-e.startX,this.layout(s.height+t,s.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))}))),this._sashListener.add(this._westSash.onDidChange((e=>{s&&(i=-(e.currentX-e.startX),this.layout(s.height+t,s.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))}))),this._sashListener.add(this._northSash.onDidChange((e=>{s&&(t=-(e.currentY-e.startY),this.layout(s.height+t,s.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))}))),this._sashListener.add(this._southSash.onDidChange((e=>{s&&(t=e.currentY-e.startY,this.layout(s.height+t,s.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))}))),this._sashListener.add(Event.any(this._eastSash.onDidReset,this._westSash.onDidReset)((s=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(Event.any(this._northSash.onDidReset,this._southSash.onDidReset)((s=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))})))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(s,t,i,e){this._northSash.state=s?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=e?3:0}layout(s=this.size.height,t=this.size.width){const{height:i,width:e}=this._minSize,{height:h,width:o}=this._maxSize;s=Math.max(i,Math.min(h,s)),t=Math.max(e,Math.min(o,t));const a=new Dimension(t,s);Dimension.equals(a,this._size)||(this.domNode.style.height=s+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(s){this._maxSize=s}get maxSize(){return this._maxSize}set minSize(s){this._minSize=s}get minSize(){return this._minSize}set preferredSize(s){this._preferredSize=s}get preferredSize(){return this._preferredSize}}