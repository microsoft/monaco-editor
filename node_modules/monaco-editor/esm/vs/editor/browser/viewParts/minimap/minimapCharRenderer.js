import{getCharIndex}from"./minimapCharSheet.js";import{toUint8}from"../../../../base/common/uint.js";export class MinimapCharRenderer{constructor(t,e){this.scale=e,this._minimapCharRendererBrand=void 0,this.charDataNormal=MinimapCharRenderer.soften(t,.8),this.charDataLight=MinimapCharRenderer.soften(t,50/60)}static soften(t,e){const r=new Uint8ClampedArray(t.length);for(let a=0,i=t.length;a<i;a++)r[a]=toUint8(t[a]*e);return r}renderChar(t,e,r,a,i,n,h,o,s,d,c){const l=1*this.scale,m=2*this.scale,g=c?1:m;if(e+l>t.width||r+g>t.height)return void console.warn("bad render request outside image data");const f=d?this.charDataLight:this.charDataNormal,C=getCharIndex(a,s),p=4*t.width,u=h.r,b=h.g,w=h.b,x=i.r-u,M=i.g-b,R=i.b-w,D=Math.max(n,o),v=t.data;let U=C*l*m,j=r*p+4*e;for(let t=0;t<g;t++){let t=j;for(let e=0;e<l;e++){const e=f[U++]/255*(n/255);v[t++]=u+x*e,v[t++]=b+M*e,v[t++]=w+R*e,v[t++]=D}j+=p}}blockRenderChar(t,e,r,a,i,n,h,o){const s=1*this.scale,d=2*this.scale,c=o?1:d;if(e+s>t.width||r+c>t.height)return void console.warn("bad render request outside image data");const l=4*t.width,m=i/255*.5,g=n.r,f=n.g,C=n.b,p=g+(a.r-g)*m,u=f+(a.g-f)*m,b=C+(a.b-C)*m,w=Math.max(i,h),x=t.data;let M=r*l+4*e;for(let t=0;t<c;t++){let t=M;for(let e=0;e<s;e++)x[t++]=p,x[t++]=u,x[t++]=b,x[t++]=w;M+=l}}}