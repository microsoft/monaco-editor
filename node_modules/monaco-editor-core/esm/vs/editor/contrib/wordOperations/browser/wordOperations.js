import{EditorAction,EditorCommand,registerEditorAction,registerEditorCommand}from"../../../browser/editorExtensions.js";import{ReplaceCommand}from"../../../common/commands/replaceCommand.js";import{EditorOptions}from"../../../common/config/editorOptions.js";import{CursorState}from"../../../common/cursorCommon.js";import{WordOperations}from"../../../common/cursor/cursorWordOperations.js";import{getMapForWordSeparators}from"../../../common/core/wordCharacterClassifier.js";import{Position}from"../../../common/core/position.js";import{Range}from"../../../common/core/range.js";import{Selection}from"../../../common/core/selection.js";import{EditorContextKeys}from"../../../common/editorContextKeys.js";import{ILanguageConfigurationService}from"../../../common/languages/languageConfigurationRegistry.js";import*as nls from"../../../../nls.js";import{CONTEXT_ACCESSIBILITY_MODE_ENABLED}from"../../../../platform/accessibility/common/accessibility.js";import{ContextKeyExpr}from"../../../../platform/contextkey/common/contextkey.js";import{IsWindowsContext}from"../../../../platform/contextkey/common/contextkeys.js";export class MoveWordCommand extends EditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,o,t){if(!o.hasModel())return;const r=getMapForWordSeparators(o.getOption(124)),i=o.getModel(),n=o.getSelections().map((e=>{const o=new Position(e.positionLineNumber,e.positionColumn),t=this._move(r,i,o,this._wordNavigationType);return this._moveTo(e,t,this._inSelectionMode)}));if(i.pushStackElement(),o._getViewModel().setCursorStates("moveWordCommand",3,n.map((e=>CursorState.fromModelSelection(e)))),1===n.length){const e=new Position(n[0].positionLineNumber,n[0].positionColumn);o.revealPosition(e,0)}}_moveTo(e,o,t){return t?new Selection(e.selectionStartLineNumber,e.selectionStartColumn,o.lineNumber,o.column):new Selection(o.lineNumber,o.column,o.lineNumber,o.column)}}export class WordLeftCommand extends MoveWordCommand{_move(e,o,t,r){return WordOperations.moveWordLeft(e,o,t,r)}}export class WordRightCommand extends MoveWordCommand{_move(e,o,t,r){return WordOperations.moveWordRight(e,o,t,r)}}export class CursorWordStartLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}export class CursorWordEndLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}export class CursorWordLeft extends WordLeftCommand{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,null===(e=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))||void 0===e?void 0:e.negate()),primary:2063,mac:{primary:527},weight:100}})}}export class CursorWordStartLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}export class CursorWordEndLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}export class CursorWordLeftSelect extends WordLeftCommand{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,null===(e=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))||void 0===e?void 0:e.negate()),primary:3087,mac:{primary:1551},weight:100}})}}export class CursorWordAccessibilityLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(e,o,t,r){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),o,t,r)}}export class CursorWordAccessibilityLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(e,o,t,r){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),o,t,r)}}export class CursorWordStartRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}export class CursorWordEndRight extends WordRightCommand{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,null===(e=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))||void 0===e?void 0:e.negate()),primary:2065,mac:{primary:529},weight:100}})}}export class CursorWordRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}export class CursorWordStartRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}export class CursorWordEndRightSelect extends WordRightCommand{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,null===(e=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))||void 0===e?void 0:e.negate()),primary:3089,mac:{primary:1553},weight:100}})}}export class CursorWordRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}export class CursorWordAccessibilityRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(e,o,t,r){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),o,t,r)}}export class CursorWordAccessibilityRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(e,o,t,r){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),o,t,r)}}export class DeleteWordCommand extends EditorCommand{constructor(e){super(e),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,o,t){const r=e.get(ILanguageConfigurationService);if(!o.hasModel())return;const i=getMapForWordSeparators(o.getOption(124)),n=o.getModel(),d=o.getSelections(),s=o.getOption(5),a=o.getOption(8),c=r.getLanguageConfiguration(n.getLanguageId()).getAutoClosingPairs(),m=o._getViewModel(),p=d.map((e=>{const t=this._delete({wordSeparators:i,model:n,selection:e,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:o.getOption(6),autoClosingBrackets:s,autoClosingQuotes:a,autoClosingPairs:c,autoClosedCharacters:m.getCursorAutoClosedCharacters()},this._wordNavigationType);return new ReplaceCommand(t,"")}));o.pushUndoStop(),o.executeCommands(this.id,p),o.pushUndoStop()}}export class DeleteWordLeftCommand extends DeleteWordCommand{_delete(e,o){return WordOperations.deleteWordLeft(e,o)||new Range(1,1,1,1)}}export class DeleteWordRightCommand extends DeleteWordCommand{_delete(e,o){const t=WordOperations.deleteWordRight(e,o);if(t)return t;const r=e.model.getLineCount(),i=e.model.getLineMaxColumn(r);return new Range(r,i,r,i)}}export class DeleteWordStartLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:EditorContextKeys.writable})}}export class DeleteWordEndLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:EditorContextKeys.writable})}}export class DeleteWordLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}export class DeleteWordStartRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:EditorContextKeys.writable})}}export class DeleteWordEndRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:EditorContextKeys.writable})}}export class DeleteWordRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}export class DeleteInsideWord extends EditorAction{constructor(){super({id:"deleteInsideWord",precondition:EditorContextKeys.writable,label:nls.localize("deleteInsideWord","Delete Word"),alias:"Delete Word"})}run(e,o,t){if(!o.hasModel())return;const r=getMapForWordSeparators(o.getOption(124)),i=o.getModel(),n=o.getSelections().map((e=>{const o=WordOperations.deleteInsideWord(r,i,e);return new ReplaceCommand(o,"")}));o.pushUndoStop(),o.executeCommands(this.id,n),o.pushUndoStop()}}registerEditorCommand(new CursorWordStartLeft),registerEditorCommand(new CursorWordEndLeft),registerEditorCommand(new CursorWordLeft),registerEditorCommand(new CursorWordStartLeftSelect),registerEditorCommand(new CursorWordEndLeftSelect),registerEditorCommand(new CursorWordLeftSelect),registerEditorCommand(new CursorWordStartRight),registerEditorCommand(new CursorWordEndRight),registerEditorCommand(new CursorWordRight),registerEditorCommand(new CursorWordStartRightSelect),registerEditorCommand(new CursorWordEndRightSelect),registerEditorCommand(new CursorWordRightSelect),registerEditorCommand(new CursorWordAccessibilityLeft),registerEditorCommand(new CursorWordAccessibilityLeftSelect),registerEditorCommand(new CursorWordAccessibilityRight),registerEditorCommand(new CursorWordAccessibilityRightSelect),registerEditorCommand(new DeleteWordStartLeft),registerEditorCommand(new DeleteWordEndLeft),registerEditorCommand(new DeleteWordLeft),registerEditorCommand(new DeleteWordStartRight),registerEditorCommand(new DeleteWordEndRight),registerEditorCommand(new DeleteWordRight),registerEditorAction(DeleteInsideWord);